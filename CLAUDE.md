# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a GitHub Action that integrates with Release Gateway to control releases in deployment pipelines. It acts as a circuit breaker - allowing releases to proceed when approved, or failing the pipeline when blocked.

## Commands

```bash
# Install dependencies
npm install

# Run tests
npm test

# Run a single test file
npm test -- test/index.test.js

# Lint code
npm run lint

# Build (compiles to dist/index.js using ncc)
npm run build
```

## Code Architecture

- **index.js** - Entry point that calls `runAction()`
- **src/run-action.js** - Main action logic: collects inputs, creates payload, sends to Release Gateway API
- **src/create-event-payload.js** - Builds the payload with GitHub context, inputs, and `GITHUB_*` environment variables
- **src/constants.js** - API URL configuration
- **dist/index.js** - Compiled bundle (auto-generated by ncc, committed via husky pre-commit hook)

## Code Style

- Uses ESLint 9 flat config (`eslint.config.js`) with Prettier integration
- Prettier handles formatting (double quotes, semicolons, trailing commas)
- Jest plugin for test files

## Git Workflow

- Husky v9 with hooks in `.husky/` directory
- Commitizen is configured for conventional commits (husky hook prompts `git cz` on commit)
- Pre-commit hook automatically runs build and stages `dist/index.js`
